<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.72.0"><meta name=description content="Writing things down helps..."><meta name=author content="What Bird Is That?"><link rel=icon href=/images/favicon.png type=image/png><title>Protecting Change With MFA :: What Bird Is That?</title><link href=/css/nucleus.css?1597553160 rel=stylesheet><link href=/css/fontawesome-all.min.css?1597553160 rel=stylesheet><link href=/css/hybrid.css?1597553160 rel=stylesheet><link href=/css/featherlight.min.css?1597553160 rel=stylesheet><link href=/css/perfect-scrollbar.min.css?1597553160 rel=stylesheet><link href=/css/auto-complete.css?1597553160 rel=stylesheet><link href=/css/atom-one-dark-reasonable.css?1597553160 rel=stylesheet><link href=/css/theme.css?1597553160 rel=stylesheet><link href=/css/hugo-theme.css?1597553160 rel=stylesheet><script src=/js/jquery-3.3.1.min.js?1597553160></script><link rel=stylesheet href=/sass/mermaid.css><script src=/mermaid/mermaid.min.js type=text/javascript></script><script type=text/javascript>window.onload=function(){mermaid.init(undefined,".language-mermaid");};</script><style>:root #header+#content>#left>#rlblock_left{display:none!important}:not(pre)>code+span.copy-to-clipboard{display:none}</style><link rel=stylesheet href=/sass/wbits.css><link rel=stylesheet href=/sass/hints-colours.css><link rel=stylesheet href=/syntax.css></head><body data-url=/posts/protecting-change-with-mfa/><nav id=sidebar><div id=header-wrapper><div id=header><a id=logo href=/><svg id="emoji" style="width:70%;height:70%" viewBox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><g id="color"><path fill="#6a462f" stroke="none" d="M40.203 22s3.1218-9 11.4467-4c0 0 8.585.75 8.9753 3.375.0.0-7.9346 1.625-10.0159 5.625s3.1218 7-5.3331 15.625c0 0-4.0324 4.375-10.276 4.375.0.0-22 3-25 0"/><path fill="#a57939" stroke="none" d="M10.125 46.875S35 24 43 25s2 13.25-5.5 17.625-27.375 4.25-27.375 4.25z"/></g><g id="hair"/><g id="skin"/><g id="skin-shadow"/><g id="line"><line x1="32.625" x2="37" y1="55.625" y2="54" fill="none" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-width="2"/><path fill="#000" stroke="none" d="M42.8504 29.4692c-.7444-.1428-.9348.5114-.9348.5114h-5e-4c-.6837 2.166-3.0652 7.1369-10.4871 10.0829l.006.0082s-.7619.2029-.443 1.0278c.2757.7122.9802.5552 1.1667.4988 8.3025-3.3272 10.7819-9.1109 11.4476-11.3398C43.6638 30.0615 43.5899 29.6108 42.8504 29.4692z"/><path fill="none" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-width="2" d="M31.625 40.875S40 39 43 29"/><path fill="none" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-width="2" d="M41 22s3-9 11-4c0 0 8.25.75 8.625 3.375C60.625 21.375 53 23 51 27s3 7-5.125 15.625C45.875 42.625 42 47 36 47l-1 2 2 5 6 1"/><path fill="none" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-width="2" d="M10.125 46.875S35 24 43 25s2 13.25-5.5 17.625-27.375 4.25-27.375 4.25z"/></g></svg></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label><input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=/js/lunr.min.js?1597553160></script><script type=text/javascript src=/js/auto-complete.js?1597553160></script><script type=text/javascript>var baseurl="\/";</script><script type=text/javascript src=/js/search.js?1597553160></script></div><div class=highlightable><ul class=topics><li data-nav-id=/posts/ title="A Blog" class="dd-item
parent"><a href=/posts/>A Blog</a><ul><li data-nav-id=/posts/transactional-mfa-sequence/ title="Transactional MFA Sequence" class=dd-item><a href=/posts/transactional-mfa-sequence/>Transactional MFA Sequence</a></li><li data-nav-id=/posts/protecting-change-with-mfa/ title="Protecting Change With MFA" class="dd-item active"><a href=/posts/protecting-change-with-mfa/>Protecting Change With MFA</a></li><li data-nav-id=/posts/retro-for-value/ title="Retro for Value" class=dd-item><a href=/posts/retro-for-value/>Retro for Value</a></li><li data-nav-id=/posts/you-are-valued/ title="You Are Valued" class=dd-item><a href=/posts/you-are-valued/>You Are Valued</a></li><li data-nav-id=/posts/retro-is-broken/ title="Retro Is Broken" class=dd-item><a href=/posts/retro-is-broken/>Retro Is Broken</a></li><li data-nav-id=/posts/clean-cloud/ title="Clean Cloud" class=dd-item><a href=/posts/clean-cloud/>Clean Cloud</a></li><li data-nav-id=/posts/notes-on-a-stack/ title="Notes on a stack" class=dd-item><a href=/posts/notes-on-a-stack/>Notes on a stack</a></li><li data-nav-id=/posts/begin-with-disaster/ title="Begin With Disaster" class=dd-item><a href=/posts/begin-with-disaster/>Begin With Disaster</a></li><li data-nav-id=/posts/test-is-a-four-letter-word/ title="TEST is a four letter word." class=dd-item><a href=/posts/test-is-a-four-letter-word/>TEST is a four letter word.</a></li><li data-nav-id=/posts/real-blog/ title="Reliable, Evolving, Agile, Lean" class=dd-item><a href=/posts/real-blog/>Reliable, Evolving, Agile, Lean</a></li><li data-nav-id=/posts/code-coverage/ title="100% Coverage is only the beginning" class=dd-item><a href=/posts/code-coverage/>100% Coverage is only the beginning</a></li></ul></li></ul><section id=footer><p>Built with <a href=https://github.com/matcornic/hugo-theme-learn><i class="fas fa-heart"></i></a>from <a href=https://getgrav.org>Grav</a> and <a href=https://gohugo.io/>Hugo</a></p></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span><span class=links><a href=/>wbits</a> > <a href=/posts/>A Blog</a> > Protecting Change With MFA</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#using-transactional-mfa-to-protect-mutative-actions>Using transactional MFA to protect mutative actions</a><ul><li><a href=#easy-mfa---challenge-at-login>&ldquo;Easy MFA&rdquo; - Challenge at Login</a></li><li><a href=#three-tradeoffs-of-mfa-at-login>Three Tradeoffs of MFA at Login</a></li><li><a href=#the-example-system>The Example System</a></li><li><a href=#read-or-compute-are-not-sensitive>READ or COMPUTE are not &lsquo;sensitive&rsquo;</a></li><li><a href=#nonrepudiation-and-identity-binding>Nonrepudiation and identity binding</a></li><li><a href=#one-time-mfa---still-a-threat>One time MFA - still a threat</a></li><li><a href=#three-tradeoffs-of-one-time-transactional-mfa>Three Tradeoffs of One Time Transactional MFA</a></li><li><a href=#all-ye-muste-mfa-the-things>All Ye Muste MFA the things</a></li></ul></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Protecting Change With MFA</h1><p>üóìÔ∏è 2020-08-15</p><p>‚è≤Ô∏è Reading time: 5 minutes and 36 seconds.</p><h2 id=using-transactional-mfa-to-protect-mutative-actions>Using transactional MFA to protect mutative actions</h2><p>When deciding whether or not to use transactional MFA to verify the identity of a user the tradeoffs are around implementation security, useability and simplicity.</p><div class="notices info"><p>Transactional MFA is the <strong>protection of specific actions</strong> by challenging for a second authentication factor. In general, these are transactional actions such as CHANGE some data. Like, to pay for something, alter a subscription, update a user&rsquo;s address.</p></div><p>There is a level of sophistication (complexity) to transactional MFA that may lead to some appearance of crossover to Authorisation. While authorisation is about allowing certain entities to access a given action based on their role transactional MFA is about increasing the amount of identification required to perform the action.</p><p>For example, to rent a video you probably only need a telephone bill, whereas to buy a big TV on credit you need a drivers&rsquo; licence and a credit card. Anyone can do these things, they just require more proof of identity.</p><h3 id=easy-mfa---challenge-at-login>&ldquo;Easy MFA&rdquo; - Challenge at Login</h3><p>In the simplest implementation and user journey, MFA is a part of the login process. Once the user is MFA&rsquo;d at login, their identity is assumed to be constant for the duration of the session.</p><pre><code class=language-mermaid data-lang=mermaid>%%{init: {'theme': 'dark'}}%%
sequenceDiagram
    participant USER as User
    participant UI as UI
    participant API as API
    participant MFA as Identity Provider
    UI -&gt;&gt; USER: SHOW &quot;Sign Up / Sign In&quot;
    note over USER,UI: Enter Username / Password
    USER -&gt;&gt; UI: CLICK &quot;Sign In&quot;
    UI --&gt;&gt; API: GET /user-mfa
    API --&gt;&gt; UI: {true|false}
    alt MFA ENABLED
    note over USER,MFA: Some complicated stuff
    else MFA NOT ENABLED
    note over USER,MFA: Nothing to do
    end
    UI -&gt;&gt; USER: SHOW Home Page Dashboard
    USER --&gt;&gt; UI: Click &lt;any button&gt;
    note over USER,API: Any action is allowed from now on

</code></pre><h3 id=three-tradeoffs-of-mfa-at-login>Three Tradeoffs of MFA at Login</h3><table><thead><tr><th>Tradeoff</th><th>Status</th></tr></thead><tbody><tr><td>Security</td><td>Some risk: for example somebody logs in at a computer in say, a classroom or office, and walks away without locking their screen or logging out.</td></tr><tr><td>Useability</td><td>Extra time spent waiting and extra buttons clicked, text copied-and-pasted (or worse, read from the phone and typed into the computer) and some users will find that disagreeable.</td></tr><tr><td>‚úÖ <strong>Simplicity</strong></td><td>The implementation is at its simplest when MFA&rsquo;ing at login.</td></tr></tbody></table><h3 id=the-example-system>The Example System</h3><p>The application uses an external system to apply changes to say, a user&rsquo;s profile data. Items such as &ldquo;nickname&rdquo;, &ldquo;favourite colour&rdquo; etc are stored in the external system (it doesn&rsquo;t matter how or where).</p><p>With transactional MFA implemented, changes to data are protected against naughtiness using multi-factor authentication. The second factor could be an SMS text, an authenticator app (such as Google Authenticator) or a one-time passcode sent to the user&rsquo;s email.</p><h3 id=read-or-compute-are-not-sensitive>READ or COMPUTE are not &lsquo;sensitive&rsquo;</h3><p>When applying transactional MFA, THE BUSINESS has decided that non-mutative actions are not to be protected using the second factor.</p><p>These actions are protected using the credentials factor alone. Username / password is considered to be sufficient protection for READ and COMPUTE operations, but a second factor is considered necessary to guard against potentially site-wide harm that may be caused by a bad actor exploiting a mutative process.</p><h3 id=nonrepudiation-and-identity-binding>Nonrepudiation and identity binding</h3><p>The second factor, while not providing complete protection (it can provide <em>added</em> protection) can be used to warn users that their identity has been proven, and the provability of that user having performed a naughty action is increased considerably because they used the second factor to confirm their identity with the system.</p><p>A bad actor would have to have compromised both factors to gain access, which &mldr; <em>might be</em> less likely than the account owner being the perpetrator of the naughty thing.</p><div class="notices warning"><p>More identifying factors <em>should</em> increase the likelihood of a verified identity. But they <em>might</em> not.</p></div><p>In this case, the system is presenting a final alert, &ldquo;are you sure you want to do this?&rdquo;, as a warning <em>and</em> as a means of identification.</p><p><a href=../transactional-mfa-sequence/>A sequence diagram</a> showing the 2nd factor guard in action.</p><h3 id=one-time-mfa---still-a-threat>One time MFA - still a threat</h3><p>The diagram above describes a posture where convenience is still a high priority. A user may wish to perform multiple sensitive actions, but will only be challenged for the 2nd factor the first time. Subsequent sensitive actions are pre-authenticated on the 2nd factor.</p><p><img src=../images/Protecting-a-CHANGE-with-2FA.svg alt="Flow Diagram"></p><h3 id=three-tradeoffs-of-one-time-transactional-mfa>Three Tradeoffs of One Time Transactional MFA</h3><p>Security is relaxed somewhat for READ operations. Of course it is still possible to require a 2nd factor at any point, the system in question has chosen to apply them only to mutative actions.</p><table><thead><tr><th>Tradeoff</th><th>Status</th></tr></thead><tbody><tr><td>Security</td><td>The securedness of mutative operations is improved. At the time of the action, rather than at some time prior, the user is challenged to provide the 2nd factor. However, should a user authenticate with the 2nd factor, then walk away and leave their computer unlocked and the session open their account is just as open to attack as if they had provided the 2nd factor at login.</td></tr><tr><td>‚úÖ <strong>Useability</strong></td><td>Useability is improved site-wide. For a user who does not want to perform mutative actions (such as VIEW their account balance) a single authentication factor is enough. Therefore, the user does not have to wait or fiddle about with obtaining and providing the 2nd factor.</td></tr><tr><td>Simplicity</td><td>Simplicity is foregone. In order to implement transactional MFA around only mutative actions, a lot of extra presentation logic is required. If there is no BFF the API itself must include challenge logic in every POST/PUT/PATCH/DELETE that is exposed. There are ways to cross-cut this, but they are still complex / complicated.</td></tr></tbody></table><h3 id=all-ye-muste-mfa-the-things>All Ye Muste MFA the things</h3><p><img src=../images/Protecting-a-CHANGE-with-2FA-stateless.svg alt="Flow Diagram"></p><table><thead><tr><th>Tradeoff</th><th>Status</th></tr></thead><tbody><tr><td>‚úÖ <strong>Security</strong></td><td>If security is the highest concern, it makes sense to have every sensitive action protected by a MFA challenge. Making the system stateless in that sense will be very inconvenient for the user, as they will need to provide the 2nd factor every time they attempt a sensitive action but it will give the most clarity around who is attempting to perform the action.</td></tr><tr><td>Useability</td><td>Useability takes a back-seat to security in this configuration, and each and every time the user wants to perform a sensitive action they must deal with the hassle of providing the 2nd factor. There are some apps that make this easier - but security and convenience are mutually exclusive.</td></tr><tr><td>Simplicity</td><td>It&rsquo;s actually somewhat simpler to implement the stateless MFA for all sensitive actions as there is no requirement to check the state of 2nd factor - it&rsquo;s always in a state of &ldquo;not provided&rdquo; for this implementation</td></tr></tbody></table><hr><h4 id=the-trade-offs-are-clear-it-is-a-matter-of-posture-and-policy>The trade-offs are clear. It is a matter of posture and policy</h4><p>At the end of the day, to 2FA or not to 2FA is the question ultimately answered by the stakeholders - and the better equipped to make that decision they are, the more appropriate to the user base that decision will be.</p><p>As with everything, &ldquo;Ye Muste Use the MFA&rdquo; or &ldquo;MFA Suxe&rdquo; are extreme views, and more often than not the real-world answer is&mldr;.</p><p>There are other implementation concerns too. For example, considering certain RBAC grants are only available to MFA entities. Once the 2nd factor is presented, a raft of new permissions are available, similarly to how we might <code>sudo</code> or elevate our role permissions temporarily on a cloud platform.</p><h4 id=references>References</h4><p>Thank you to the writers of these articles:</p><p><a href=https://developer.okta.com/blog/2019/12/19/multi-factor-authentication-sucks>Multi-Factor Authentication Sucks</a></p><p><a href=https://developer.okta.com/blog/2020/02/07/transactional-mfa>Never Build MFA Again: A Developer&rsquo;s Guide to Transactional MFA</a></p><p><a href="https://support.okta.com/help/s/article/Beginner-s-Guide-to-SAML?language=en_US">Beginner&rsquo;s Guide to SAML</a></p><footer class=footline></footer></div></div><div id=navigation></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js?1597553160></script><script src=/js/perfect-scrollbar.min.js?1597553160></script><script src=/js/perfect-scrollbar.jquery.min.js?1597553160></script><script src=/js/jquery.sticky.js?1597553160></script><script src=/js/featherlight.min.js?1597553160></script><script src=/js/highlight.pack.js?1597553160></script><script>hljs.initHighlightingOnLoad();</script><script src=/js/modernizr.custom-3.6.0.js?1597553160></script><script src=/js/learn.js?1597553160></script><script src=/js/hugo-learn.js?1597553160></script></body></html>